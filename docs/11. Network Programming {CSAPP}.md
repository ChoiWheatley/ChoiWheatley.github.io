---
aliases: 
tags: 
description:
title: 11. Network Programming {CSAPP}
created: 2023-09-14T20:21:34
updated: 2023-09-18T21:29:06
---

- [[week06 {swjungle}{proxy-lab}]]
- [[Computer Networking, a top down approach - Kurose, James F. Ross, Keith W.]]

## Chapters Preview

### 11.1. The Client Server Programming Model

í´ë¼ì´ì–¸íŠ¸ & ì„œë²„ ëª¨ë¸ì€ ë¦¬í€˜ìŠ¤íŠ¸ & ë¦¬ìŠ¤í°ìŠ¤ ëª¨ë¸ê³¼ ì–´ë–¤ ì ì—ì„œ ë‹¤ë¥¸ì§€, ë‹¤ë¥¸ ëª¨ë¸ê³¼ ë¹„êµí•´ì„œ ì–´ë–¤ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ ì•Œê³ ì‹¶ë‹¤. ì‚¬ì‹¤ ë„ˆë¬´ ë‹¹ì—°í–ˆì§€ë§Œ ë‹¹ì—°í•œ ë§Œí¼ ìƒê°í•˜ì§€ ì•Šì•˜ë˜ ì£¼ì œì´ê¸°ë„ í•˜ê³ .

### 11.2. Networks

ë„¤íŠ¸ì›Œí¬ ì§€ì‹ì„ í•¨ì–‘í•˜ëŠ” ì±•í„°ì¸ë“¯, OSI 7 Layersì— ëŒ€í•œ ë‚´ìš©ì´ ë¶„ëª… ë‚˜ì˜¬ ê²ƒì´ê³ , ì´ ì±…ì€ ê·¸ê±¸ ë‹¤ ë‹¤ë£¨ëŠ” ê±´ ì•„ë‹ˆê³ , ë„¤íŠ¸ì›Œí¬ ì±…ì´ ë”°ë¡œ ìˆê¸°ë„ í•  ì •ë„ë¡œ ë¶„ëŸ‰ì´ ë°©ëŒ€í•˜ë‹ˆê¹Œ. ê±°ì˜ ìƒìœ„ ë ˆì´ì–´ (Network Layer, Transport Layer ë“±ë“±)ì— ëŒ€í•´ì„œ ë‹¤ë£¨ì§€ ì•Šì„ê¹Œ? ê·¸ë‚˜ë§ˆë„ ê¸°ì–µì´ ê°€ë¬¼ê°€ë¬¼í•˜ë‹¤. ê³¼ê±° ìˆ˜ì—…ë‚´ìš©ì„ ì°¸ê³ í•˜ì.

### 11.3. The Global IP Internet

*Inter*netì¸ ë§Œí¼, ë„¤íŠ¸ì›Œí¬ì™€ ë„¤íŠ¸ì›Œí¬ë¥¼ ì´ì–´ì£¼ëŠ” ê³„ì¸µì¸ ë„¤íŠ¸ì›Œí¬ ê³„ì¸µì— ì‹¬ë„ìˆëŠ” ë‚´ìš©ì´ ë‚˜ì˜¬ ê²ƒ ê°™ë‹¤. ì–´ë–»ê²Œ IPë¡œ í˜¸ìŠ¤íŠ¸ë¥¼ ì‹ë³„í•˜ëŠ”ì§€, ë¼ìš°íŒ…ì„ ì–´ë–»ê²Œ í•˜ê³  ê·¸ë˜í”„ë¡œ í‘œí˜„ëœ ë„¤íŠ¸ì›Œí¬ ì„¸ìƒ ì†ì—ì„œ ìµœì  ê²½ë¡œë¥¼ ì°¾ì•„ê°€ëŠ”ì§€ì— ëŒ€í•œ ë‚´ìš©ì´ ë“¤ì–´ìˆì„ ê²ƒ ê°™ë‹¤.

### 11.4. The Sockets Interface

ì†Œì¼“ í†µì‹ ì€ ì–´ëŠ ì˜ì—­ì— ì†í•˜ì§€? ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ë³´ë‹¤ í•œ ë‹¨ê³„ ì˜¬ë¼ê°„ ì „ì†¡ê³„ì¸µì¸ê±´ê°€? í¬íŠ¸í¬ì›Œë”©ì´ ì—¬ê¸°ì—ì„œ ë‚˜ì˜¤ë‚˜? ë¶„ëª… [[Linux IPC Programming {inflearn archive}]] ê³µë¶€í–ˆì„ ë•Œ ì†Œì¼“ì— ëŒ€í•œ ë‚´ìš©ì„ ë“¤ì—ˆë˜ ê²ƒ ê°™ê¸°ë„ í•˜ê³  [[0016 Systems Programming {ssu2021-1st} ğŸ¼]] ì‹œê°„ì— íŒŒì¼ ë””ìŠ¤í¬ë¦½í„° ê´€ë ¨í•´ì„œ ë“¤ì—ˆë˜ ê²ƒ ê°™ê¸°ë„ í•˜ë‹¤. ë¹ ëœ¨ë¦° ë‚´ìš©ì„ ì±… ë¿ë§Œ ì•„ë‹ˆë¼ ì´ëŸ° ê³³ì—ì„œë¡œë¶€í„° ì ê·¹ì ìœ¼ë¡œ ì°¸ê³ í•˜ì—¬ ë©”ê¿”ë³´ì. 

### 11.5. Web Servers

ë°”ë¡œ ë‹¤ìŒì¥ì´ Tiny Web Serverë¥¼ ë§Œë“¤ê¸° ë•Œë¬¸ì— ê·¸ê±¸ ìœ„í•œ ì¤€ë¹„ê³¼ì •ì´ ë“¤ì–´ê°ˆ ê²ƒ ê°™ë‹¤. ì–´ë–¤ ì›¹ ì„œë²„ë¥¼ ë§Œë“¤ê¹Œ? ì¼ë‹¨ ì†Œì¼“ APIì™€ File Descriptorë¥¼ í™œìš©í•œ ë°©ì‹ì€ ê¼­ ë“¤ì–´ê°€ê² ì§€. ì½”ë“œê°€ ë‚˜ì™€ì£¼ì–´ì•¼ í•˜ë‹ˆê¹Œ.

### 11.6. Puttling It Together: The Tiny Web Server

ì§ì ‘ Cë¡œ ì›¹ ì„œë²„ë¥¼ ë§Œë“¤ì–´ ë³´ë©´ì„œ ë§ë”±ëœ¨ë¦´ ë‹¤ì–‘í•œ í•¨ìˆ˜ë“¤ê³¼ í¬íŠ¸, IP, í”„ë¡œì„¸ìŠ¤ ìƒì„± ë“±ì— ëŒ€í•œ ë‚´ìš©ì´ ë‚˜ì˜¬ ê²ƒ ê°™ë‹¤. [[week06 {swjungle}{proxy-lab}#2023-09-14 ëª©]] íšŒì˜ ê²°ê³¼ì— ë”°ë¥´ë©´ ì—¬ê¸°ê¹Œì§€ 15ì¼ ê¸ˆìš”ì¼ê¹Œì§€ ì–´ë–»ê²Œë“  ë„ë‹¬í•œ ë’¤ì— ë†“ì¹˜ê³  ê°„ ì§€ì‹ì„ ë°± íŠ¸ë˜í‚¹ í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ë„ì…í•´ ë³´ë ¤ê³  í•œë‹¤. 

## ì‹¤ìŠµë¨¼ì €, êµ¬ë©ì€ ë‚˜ì¤‘ì— ë©”ê¾¸ì

### 11.4.9. Example Echo Client and Server

**Client (Figure 11.20)** 

ì„œë²„ì™€ ì—°ê²°(`Open_clientfd`)ì„ ë§ºì€ ë’¤ í´ë¼ì´ì–¸íŠ¸ëŠ” ë£¨í”„ë¥¼ ëŒë©´ì„œ stdinìœ¼ë¡œë¶€í„° text lineì„ ì…ë ¥ë°›ê³ (`Fgets`) ì„œë²„ì—ê²Œ ì „ì†¡í•œë‹¤(`Rio_writen`). ì„œë²„ë¡œë¶€í„° ì‘ë‹µì„ ìˆ˜ì‹ í•˜ê³ (`Rio_readlineb`) stdoutìœ¼ë¡œ ì—ì½” ê²°ê³¼ë¥¼ ì¶œë ¥í•œë‹¤ (`Fputs`)

**Server (Figure 11.21)**

ì„œë²„ í”„ë¡œì„¸ìŠ¤ëŠ” ì—ì½” ì„œë²„ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ listening desciptorë¥¼ ì—´ê³ (`Open_listenfd`) ë¬´í•œë£¨í”„ ì•ˆì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìš”ì²­ì„ ê¸°ë‹¤ë¦°ë‹¤(`Accept`). í´ë¼ì´ì–¸íŠ¸ì˜ ë„ë©”ì¸ ë„¤ì„ê³¼ í¬íŠ¸ë¥¼ ì¶œë ¥í•œë‹¤.(`GetnameInfo`). `echo` í•¨ìˆ˜ ì•ˆì—ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µì„ ì†¡ì‹ í•œë‹¤. `echo`ê°€ ëë‚˜ë©´, ì—°ê²°ëœ descriptorë¥¼ ë‹«ê³ (`Close`) ë‹¤ì‹œ ë‹¤ìŒ ì´í„°ë ˆì´ì…˜ìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤.

**echo routine (Figure 11.22)**

echo ë£¨í‹´ì€ ë°˜ë³µì ìœ¼ë¡œ ì½ê³ (`Rio_readlineb`) ì“´ë‹¤(`Rio_writen`). EOFë¥¼ ë§Œë‚˜ë©´ server ë©”ì¸ ë£¨í”„ë¥¼ ë‹¤ì‹œ ëŒê²Œ ëœë‹¤.

**ìš”êµ¬ì‚¬í•­**

- EOFë¥¼ ë°›ìœ¼ë©´ ë¬´í•œë£¨í”„ë¥¼ ì¢…ë£Œí•˜ê³  fdë¥¼ ë‹«ì„ ê²ƒ, ì»¤ë§¨ë“œ ë¼ì¸ì—ì„œ Ctrl + Dë¥¼ ëˆ„ë¥´ë©´ EOFê°€ ì „ì†¡ëœë‹¤.

**helper functions** `csapp.c`

- `open_listenfd`: Opens and returns a listening descriptor. 
	- ì—°ê²°ë¦¬ìŠ¤íŠ¸ `struct addrinfo listp` ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ìš°ë¦¬ê°€ ==bind==í•  ìˆ˜ ìˆëŠ” descriptorë¥¼ ì°¾ëŠ”ë‹¤.
	- [?] `struct addrinfo`ëŠ” ì—°ê²°ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆëŠ”ë°, `getaddrinfo`ë¼ëŠ” ë…€ì„ì„ í˜¸ì¶œí•˜ë©´ì„œ ë¦¬ìŠ¤íŠ¸ì˜ ì›ì†Œë¥¼ ì–»ì–´ì˜¤ë‚˜ë³´ë‹¤.
	- `Setsockopt`, `Getaddrinfo`, `Close`, `Freeaddrinfo` ì™€ ê°™ì´ ëŒ€ë¬¸ìë¡œ ì‹œì‘í•˜ëŠ” í•¨ìˆ˜ë“¤ì€ ì±…ì—ì„œ ì •ì˜í•œ í—¬í¼í•¨ìˆ˜ë“¤ì´ë‹¤.
- `rio_readinitb(rio_t *rp, int fd)`: Associate a descriptor with a read buffer and reset buffer. rio ë²„í¼ì™€ fdë¥¼ ì´ˆê¸°í™” ì‹œí‚¤ëŠ” í•¨ìˆ˜.
- `rio_writen(int fd, void *usrbuf, size_t n)`: Robustly write n bytes (unbuffered)
- `rio_readlineb(rio_t *rp, void *usrbuf, size_t maxlen)`

**ì‹¤ìŠµê²°ê³¼**

![[ìŠ¤í¬ë¦°ìƒ· 2023-09-15 ì˜¤í›„ 3.38.34.png]]

### 11.5.3. Http Transactions 

**`telnet` ì‹¤ìŠµ ê²°ê³¼**

<www.aol.com> ìª½ì€ 403 Redirectedê°€ ë– ì„œ êµ¬ê¸€ë¡œ ë°”ê¿¨ë‹¤.

![[ìŠ¤í¬ë¦°ìƒ· 2023-09-15 ì˜¤í›„ 3.57.30.png]]

### 11.5.4. Serving Dynamic Content

**`tiny/cgi-bin/adder.c`**

- [?] [man strchr(3)](https://www.man7.org/linux/man-pages/man3/strchr.3.html) - returns a pointer to the first occurence of the character `c` in the string `s`
- [?] ~~ì•„, `sprintf`ë¥¼ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•´ë„ íƒ€ê²Ÿ ì¸ìì˜ ì¶œë°œìœ„ì¹˜ë¥¼ êµ³ì´ ë°”ê¾¸ì§€ ì•Šì•„ë„ ì•Œì•„ì„œ ë’¤ì— append ë˜ëŠ”ê°‘ë‹¤ë³´ë‹¤.~~ ì•„ë‹ˆ, ë§¤ë²ˆ ë¬¸ìì—´ ì•ì—ë‹¤ `%s` í•˜ê³  ë’¤ì— ìê¸° ìì‹ ì„ ì¸ìë¡œ ë„£ê³  ìˆì—ˆë‹¤

### 11.6 Putting It Together: The `TINY` Web Server

**`tiny/tiny.c:main`**  

- [?] ë„ëŒ€ì²´ `struct socketaddr_storage`ëŠ” ë­í•˜ëŠ” ë…€ì„ì´ëƒ? ìŸ¤í•œí…Œ `sizeof`ëŠ” ì™œ ë‹¤ëŠ”ê±°ì§€?
- [?] `stat.h`
	- `S_ISREG` macro function
	- `S_IRUSR`, `S_IXUSR` => [[Access permission bits defined in sys stat.h]]
	- `stat` function
	- `struct stat::st_mode`

**`tiny/tiny.c:doit`**  
**`tiny/tiny.c:clienterror`**  
**`tiny/tiny.c:parse_uri`**  
**`tiny/tiny.c:serve_static`**  
**`tiny/tiny.c:serve_dynamic`**

## 11.1. The Client-Server Programming Model

- *cardinality*: Client : server = N : 1, client_process : server_process = 1 : 1, ì¦‰, ì„œë²„ í”„ë¡œì„¸ìŠ¤ëŠ” ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ í•˜ë‚˜ì”© ìƒì„±ëœë‹¤.
- *Request*: í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë²„ì—ê²Œ ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­í•œë‹¤. ì„œë¹„ìŠ¤ëŠ” êµ¬ì²´ì ìœ¼ë¡œ ì„œë²„ì—ê²Œ ìš”ì²­ì„ ë³´ë‚´ëŠ” íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì‹œì‘ë  ìˆ˜ ìˆë‹¤. (â‰  DBì˜ ACID ê·œì¹™ì— ë”°ë¥¸ íŠ¸ëœì­ì…˜)
- *Response*: ì„œë²„ëŠ” (ì„œë²„ í”„ë¡œì„¸ìŠ¤) requestì— ë”°ë¼ ë™ì‘ì„ ìˆ˜í–‰í•œë‹¤. fileì„ ì½ì„ ìˆ˜ë„ ìˆê³ , í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤. í•˜ì§€ë§Œ ë°˜ë“œì‹œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µì„ ë³´ë‚´ì•¼ í•˜ë©°, íŒŒì¼ì´ë‚˜ ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼ì„ ë³´ë‚´ì£¼ê²Œ ëœë‹¤.

## 11.2. Networks

NIC(Network Interface Card), ì‰½ê²Œë§í•´ ëœì¹´ë“œë¥¼ ë©”ì¸ë³´ë“œì— ê½‚ìœ¼ë©´ ì¸í„°ë„·ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ê·¸ëŸ°ë° ëœì¹´ë“œë¥¼ "ê½‚ëŠ”ë‹¤"ëŠ” ê²ƒì´ ì •í™•íˆ ë¬´ì—‡ì„ í•˜ëŠ” ì¼ì¼ê¹Œ?

> IO ë²„ìŠ¤ì— ë‹¬ë ¤ìˆëŠ” ì–´ëŒ‘í„°ëŠ” í•˜ë“œì›¨ì–´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤. DMA ê¸°ìˆ ë¡œ CPU ê°„ì„­ ì—†ì´ ì–´ëŒ‘í„°ì—ì„œ ë°›ì€ ì‹ í˜¸ë¥¼ IOë²„ìŠ¤ë¥¼ í†µí•´ ë©”ëª¨ë¦¬ë¡œ ë³µì‚¬í•  ìˆ˜ ìˆìœ¼ë©°, ë§ˆì°¬ê°€ì§€ë¡œ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì—ì„œ ì–´ëŒ‘í„°ë¡œ ë³µì‚¬í•  ìˆ˜ë„ ìˆë‹¤.

ë„¤íŠ¸ì›Œí¬ëŠ” ê³„ì¸µêµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì œì¼ë¨¼ì € ê°€ì¥ ì‘ì€ ë‹¨ìœ„ì˜ ë„¤íŠ¸ì›Œí¬ì¸ LANì´ ìˆë‹¤. í—ˆë¸Œë‚˜ ìŠ¤ìœ„ì¹˜ë¥¼ í†µí•´ ì„œë¡œ ë¬¼ë¦¬ì ìœ¼ë¡œ ì—°ê²°ë˜ì–´ìˆë‹¤. ëª¨ë“  ì´ë”ë„· ì–´ëŒ‘í„°(ëœì¹´ë“œ)ëŠ” ë°ì´í„°ë¥¼ frame ë‹¨ìœ„ë¡œ ë³´ê²Œ ë˜ëŠ”ë°, frame ì•ˆì—ëŠ” ì¶œë°œì£¼ì†Œ, ëª©ì ì§€ ì£¼ì†Œê°€ ë‹´ê¸´ í—¤ë”, í˜ì´ë¡œë“œ, í”„ë ˆì„ ê¸¸ì´ì •ë³´ê°€ ë‹´ê²¨ìˆë‹¤. í˜¸ìŠ¤íŠ¸ì˜ ëª¨ë“  í•˜ìœ„ ë ˆì´ì–´ê°€ ê·¸ë ‡ê² ì§€ë§Œ, ì´ë”ë„· ì–´ëŒ‘í„°ë¥¼ ì˜ˆë¡œ ë“¤ë©´ ì–´ëŒ‘í„°ëŠ” ì˜¤ë¡œì§€ í˜ì´ë¡œë“œë¥¼ ì œì™¸í•œ í—¤ë”, frame lengthì—ë§Œ ê´€ì‹¬ì„ ê°–ëŠ”ë‹¤. ì§„ì§œ í˜ì´ë¡œë“œëŠ” ì˜¤ë¡œì§€ í˜¸ìŠ¤íŠ¸ë§Œ ë³¼ ìˆ˜ ìˆë‹¤.

**bridges**

ë¸Œë¦¿ì§€ëŠ” ì´ë”ë„· ì„¸ê·¸ë¨¼íŠ¸ë“¤ ì‚¬ì´ë¥¼ ì—°ê²°í•˜ëŠ” ì—­í• ì„ ê°€ì§€ê³  ìˆë‹¤. ë°© í•œ ì¹¸ì„ LANì´ ë‹´ë‹¹í–ˆë‹¤ë©´ ê±´ë¬¼ í•˜ë‚˜ ë˜ëŠ” ìº í¼ìŠ¤ í•˜ë‚˜ë¥¼ ë¬¶ì–´ì£¼ê¸° ìœ„í•´ ë¸Œë¦¿ì§€ê°€ ë“¤ì–´ê°„ë‹¤. ë¸Œë¦¿ì§€-ë¸Œë¦¿ì§€ ì—°ê²°ë„ ìˆê³  ë¸Œë¦¿ì§€-í—ˆë¸Œ ì—°ê²°ë„ ì¡´ì¬í•œë‹¤. ë¸Œë¦¿ì§€ëŠ” í•œ ì„¸ê·¸ë¨¼íŠ¸ì—ì„œ ë‹¤ë¥¸ ì„¸ê·¸ë¨¼íŠ¸ë¡œ ë„˜ì–´ê°€ì•¼ í•˜ëŠ” ì‹ í˜¸ë¥¼ ì„ ë³„ì ìœ¼ë¡œ ê³¨ë¼ í•„ìš”í•œ ë†ˆë§Œ ë³µì œí•˜ì—¬ ì‹ í˜¸ë¥¼ ì „íŒŒí•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ í•˜ë‚˜ì˜ í—ˆë¸Œì— ë¬¶ì¸ ë‘ í˜¸ìŠ¤íŠ¸ A, BëŠ” ê°™ì€ ì´ë”ë„· ì„¸ê·¸ë¨¼íŠ¸ì— ìˆë‹¤. Aê°€ Bì—ê²Œ í”„ë ˆì„ì„ ë³´ë‚´ë©´ í—ˆë¸ŒëŠ” í•­ìƒ ëª¨ë“  ë§í¬ë¡œ ê°™ì€ ì‹ í˜¸ë¥¼ ë³µì œí•œë‹¤ê³  í–ˆì§€. (í—ˆë¸Œê°€ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” êµ¬ê°„ì„ Collision Domainì´ë¼ê³ ë„ í•œë‹¤.) ê·¸ë˜ì„œ Bë˜í•œ í”„ë ˆì„ì„ ë°›ì•„ ì›í•˜ëŠ” ëª©ì ì„ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤. ë¬¸ì œëŠ” í—ˆë¸ŒëŠ” ë¸Œë¦¿ì§€ì—ê²Œë„ ì‹ í˜¸ë¥¼ ì´ë²„ë ¸ë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë•Œ ë¸Œë¦¿ì§€ëŠ” ë˜‘ë˜‘í•˜ê²Œ ì‹ í˜¸ë¥¼ ë¬´ì‹œí•˜ëŠ”ë°, ê°™ì€ ì´ë”ë„· ì„¸ê·¸ë¨¼íŠ¸ì— ìˆëŠ” ì‹ í˜¸ë¥¼ êµ³ì´ ë°–ìœ¼ë¡œ ì „íŒŒí•´ë´¤ì ë¬´ì˜ë¯¸í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

> [!question]- ê·¸ë˜ì„œ, ì´ë”ë„· ì„¸ê·¸ë¨¼íŠ¸ê°€ ë­”ë°?  
> [Network Segment {wiki}](https://en.wikipedia.org/wiki/Network_segment)ì— ë”°ë¼, ê³µìœ  ë§¤ì§ˆì— ë”°ë¼ ì „ê¸°ì ìœ¼ë¡œ ì—°ê²°ëœ ë„¤íŠ¸ì›Œí¬ ê¸°ê¸°ë“¤ì„ **ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë¨¼íŠ¸**ë¼ê³  ë¶€ë¥¸ë‹¤. ê·¸ëŸ¬ë‹ˆê¹Œ ëœì„ ìœ¼ë¡œ ì§ì ‘ ì—°ê²°ì´ ë˜ë˜, ìŠ¤ìœ„ì¹˜ë‚˜ í—ˆë¸Œì— ì˜í•´ ê°„ì ‘ì ìœ¼ë¡œ ì—°ê²°ì´ ë˜ë˜ ê²°êµ­ ê°™ì€ ë§¤ì§ˆì— ì˜í•´ ì „ê¸°ì ìœ¼ë¡œ ì—°ê²°ì´ ë˜ì–´ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ë“¯.  
> ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë¨¼íŠ¸ëŠ” OSI ë ˆì´ì–´ì™€ ê°™ì´ ê°€ëŠ”ë°, ì´ë”ë„· ì„¸ê·¸ë¨¼íŠ¸ëŠ” ë¬¼ë¦¬ì˜ì—­ì¸ OSI 1ì— í•´ë‹¹í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ ì„¸ê·¸ë¨¼íŠ¸ì´ë‹¤. 

**Routers**

ë¸Œë¦¿ì§€ê°€ LANê³¼ LAN ì‚¬ì´ë¥¼ ì´ì–´ì£¼ëŠ” ê±´ ì•Œê² ì–´. ì´ë”ë„· ì„¸ê·¸ë¨¼íŠ¸ë¼ê³  ë¶ˆë¦¬ìš°ëŠ” í˜¸í™˜ë˜ëŠ” ì˜ì—­ ì•ˆì—ì„œ ì¡°ê¸ˆ í° ë‹¨ìœ„ë¡œ ë¬¶ì–´ì£¼ëŠ” ë†ˆì¸ê±°ì§€. ê·¸ëŸ¬ë©´ ë¼ìš°í„°ëŠ” í•  ì¼ì´ ì—†ê² ë„¤?

> ë¼ìš°í„°ëŠ” ì„œë¡œ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” LANê³¼ WANì„ ì´ì–´ì£¼ì–´ Interconnected Networkë¥¼ êµ¬ì„±í•œë‹¤.

ì§€êµ¬ëŠ” ë„“ì–ì•„. íšŒì‚¬ë„ ë§ê³ . ë‹¤ë“¤ ìµœê³ ì˜ ê¸°ìˆ ë ¥ì„ ìë‘í•˜ë‹¤ë³´ë©´ ì–´ë–¤ ê³³ì€ ê´‘ëœì„ ì“°ëŠ” ê³³ë„ ìˆê³ , ë™ì¶• ì¼€ì´ë¸” ë‚´ì§€ëŠ” twisted copper wireë¥¼ ì“°ëŠ” ê³³ë„ ìˆì„ ê±°ê³ . ë¸Œë¦¿ì§€ëŠ” ì´ëŸ° ê·œê²©ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ì§€ ëª»í•œë‹¤. ì„¸ìƒì´ í•˜ë‚˜ë¡œ ì—°ê²°ë˜ê¸° ìœ„í•´ì„œ í”„ë¡œí† ì½œì´ë¼ëŠ” ê³µí†µê·œì•½ì„ ë§Œë“¤ì–´ë†“ê³  ë„¤íŠ¸ì›Œí¬ë“¤ì´ ì´ê²ƒë§Œí¼ì€ ë°˜ë“œì‹œ êµ¬í˜„í•˜ë„ë¡ ë§Œë“¤ì—ˆë‹¤. í¬ê²Œ ë‘ ê°€ì§€ ê·œì•½ì´ ìˆë‹¤.

1. Naming Scheme: IPì£¼ì†Œë¡œ ë¶ˆë¦¬ìš°ëŠ” ì£¼ì†Œ ì‹ë³„ ê·œì¹™ì´ë‹¤.
2. Delivery Mechanism: ë¹„íŠ¸ë¥¼ íŒ¨í‚·ìœ¼ë¡œ ê°ì‹¸ëŠ” ë°©ë²•ì— ëŒ€í•œ ê·œì¹™ì´ë‹¤.

ë‹¤ìŒì€ ë‘ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” LAN ì‚¬ì´ì— í˜ì´ë¡œë“œë¥¼ ì „ì†¡í•˜ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì— ëŒ€í•´ì„œ ì„¤ëª…í•œë‹¤.

1. LAN1 ì˜ì—­ì˜ Host AëŠ” ì˜†ë™ë„¤ LAN2ì— ì‚¬ëŠ” Host Bì—ê²Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê¸° ìœ„í•´ ì‹œìŠ¤í…œ ì½œì„ ì‚¬ìš©í•˜ì—¬ ì»¤ë„ ë²„í¼ì— ë©”ì‹œì§€ë¥¼ ë³µì‚¬í•œë‹¤.
2. í”„ë¡œí† ì½œ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” (ëª‡ ë‹¨ê³„ê°€ ìˆ¨ì–´ìˆê¸°ëŠ” í•˜ì§€ë§Œ) ê°ê° íŒ¨í‚· í—¤ë”ì™€ í”„ë ˆì„ í—¤ë”ë¥¼ ë¶™ì—¬ ì—¬ëŸ¬ê°œì˜ ì‘ì€ í”„ë ˆì„ìœ¼ë¡œ ë‚˜ëˆ„ì–´ Host A ì–´ëŒ‘í„°ì—ê²Œ í”„ë ˆì„ì„ ì „ë‹¬í•œë‹¤.
3. Host A ì–´ëŒ‘í„°ëŠ” ë„¤íŠ¸ì›Œí¬ë§(í˜¸ìŠ¤íŠ¸ A ë°–)ìœ¼ë¡œ í”„ë ˆì„ì„ ì „ë‹¬í•œë‹¤. (êµ¬ì²´ì ìœ¼ë¡œ ë¼ìš°í„°ì—ê²Œ ë³´ë‚´ëŠ” í–‰ìœ„ê°€ ì•„ë‹Œê°€ë³´ë„¤)
4. í”„ë ˆì„ì„ ë°›ì€ ë¼ìš°í„°ì˜ ì–´ëŒ‘í„°(LAN1 ì–´ëŒ‘í„°)ëŠ” ë¼ìš°í„° ì•ˆì— ìƒì£¼í•œ í”„ë¡œí† ì½œ ì†Œí”„íŠ¸ì›¨ì–´ì—ê²Œ í”„ë ˆì„ì„ ì „ë‹¬í•œë‹¤.
5. í”„ë¡œí† ì½œ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” í”„ë ˆì„ > íŒ¨í‚· ìˆœìœ¼ë¡œ ì—´ì–´ì¬ê»´ íŒ¨í‚· í—¤ë”ì— ë‹´ê¸´ ëª©ì ì§€ ì£¼ì†Œë¥¼ ë¼ìš°íŒ… í…Œì´ë¸”ì— ë„£ê³  ëŒë¦°ë‹¤. LAN2ê°€ ë‚˜ì™”ë‹¤ê³  ì¹˜ë©´ í”„ë¡œí† ì½œ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ê¸°ì¡´ LAN1 í”„ë ˆì„ í—¤ë”ë¥¼ LAN2 í”„ë ˆì„ í—¤ë”ë¡œ ë°”ê¿”ì¹˜ê¸° í•œ í›„ ê°™ì€ ë¼ìš°í„° ì•ˆì— ìˆëŠ” LAN2 ì–´ëŒ‘í„°ë¡œ í”„ë ˆì„ì„ ì „ë‹¬í•œë‹¤.
6. ë¼ìš°í„°ì˜ LAN2 ì–´ëŒ‘í„°ëŠ” LAN2 ë„¤íŠ¸ì›Œí¬ì— í”„ë ˆì„ì„ ì „íŒŒí•œë‹¤.
7. Host Bê°€ í”„ë ˆì„ì„ ìˆ˜ì‹ í•˜ê²Œ ë˜ë©´, HostB ì–´ëŒ‘í„°ê°€ ë¨¼ì € í”„ë ˆì„ì„ ì½ê³  í”„ë¡œí† ì½œ ì†Œí”„íŠ¸ì›¨ì–´ì—ê²Œ í”„ë ˆì„ì„ ì „ë‹¬í•œë‹¤.
8. Host Bì˜ í”„ë¡œí† ì½œ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” í”„ë ˆì„ í—¤ë”ì™€ íŒ¨í‚· í—¤ë”ë¥¼ ë²—ê²¨ë‚´ ëª©ì ì§€ í”„ë¡œì„¸ìŠ¤ì˜ ê°€ìƒë©”ëª¨ë¦¬ ê³µê°„ì— í˜ì´ë¡œë“œ ë‚´ìš©ì„ ë³µì‚¬í•œë’¤ ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ì—¬ ê·¸ ë‚´ìš©ì„ ì½ì„ ìˆ˜ ìˆê²Œëœë‹¤.

## 11.3. The Global IP Internet

Internet Protocolì˜ ì—­í• ì€ ì„œë¡œ ë‹¤ë¥¸ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ë‘ ë„¤íŠ¸ì›Œí¬ ê°„ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì¤€ë‹¤ê³  í–ˆë‹¤. IP í†µì‹ ì€ ì‹œìŠ¤í…œ ì½œì¸ ì†Œì¼“ apië¥¼ í†µí•´ ê°€ëŠ¥í•˜ë‹¤. IPëŠ” ë°ì´í„°ê·¸ë¨ì´ ëˆ„ë½ëëŠ”ì§€, ì¤‘ë³µëëŠ”ì§€ ì—¬ë¶€ë¥¼ ì¡°ì‚¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìƒìœ„ ë ˆì´ì–´ì¸ TCPì—ì„œ ì»¤ë„¥ì…˜ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹ ë¢°ë„ ìˆëŠ” í†µì‹ ì„ ë³´ì¥í•œë‹¤.

**IP Addresses**

ì „ ì„¸ê³„ ëª¨ë“  í˜¸ìŠ¤íŠ¸ëŠ” 32ë¹„íŠ¸ unsigned ì •ìˆ˜í˜•ìœ¼ë¡œ ëœ ì£¼ì†Œë¥¼ ê°€ì§€ê³  ìˆë‹¤. ëª¨ë“  ë„¤íŠ¸ì›Œí¬ëŠ” byte orderingì´ ë¹… ì—”ë””ì–¸ì´ë‹¤. `arpa/inet.h` í—¤ë”ì—ëŠ” ë°”ì´íŠ¸ ì˜¤ë”ë¥¼ ë„¤íŠ¸ì›Œí¬ì—ì„œ í˜¸ìŠ¤íŠ¸ë¡œ, í˜¸ìŠ¤íŠ¸ì—ì„œ ë„¤íŠ¸ì›Œí¬ë¡œ ë°”ê¿”ì£¼ëŠ” í•¨ìˆ˜ `ntoh[l/s]`, `hton[l/s]`ê°€ ìˆë‹¤.

ë‹¨ìˆœ ìˆ«ìì´ê¸´ í•˜ì§€ë§Œ ì™¸ìš°ê¸° ë¶ˆí¸í•˜ê¸° ë•Œë¬¸ì— 8ë¹„íŠ¸ì”© ìª¼ê°œì–´ 4ê°œì˜ 1ë°”ì´íŠ¸ í¬ê¸°ì˜ ì •ìˆ˜í˜•ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤. `inet/in.h` í—¤ë”ì—ëŠ” ì‚¬ëŒì´ ë³´ëŠ” ì•„ì´í”¼ì£¼ì†Œë¥¼ 32ë¹„íŠ¸ unsigned ì •ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” `inet_ntop`ì™€ ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œë¥¼ ì‚¬ëŒì´ ì½ê¸° í¸í•œ `inet_pton`ìœ¼ë¡œ ì œê³µë˜ê³  ìˆë‹¤.

### 11.3.2. Internet Domain Names

ê·¸ëŸ°ë°, ì‚¬ëŒë“¤ì€ ê²Œì„ëŸ¬í„°ì ¸ì„œ 8ë¹„íŠ¸ ìˆ«ì ë„¤ê°œë¥¼ ê¸°ì–µí•˜ê³  ì‹¶ì–´í•˜ì§€ë„ ì•Šì•˜ë‹¤. ë”°ë¼ì„œ ë„ë©”ì¸ê³¼ ì•„ì´í”¼ë¥¼ ë§¤í•‘í•œ DNS(Domain Name System)ë¥¼ í†µí•´ ìœ ì €ë“¤ì˜ í¸ì˜ì„±ì„ ë„ëª¨í–ˆë‹¤. ë„ë©”ì¸ ì´ë¦„ì€ íŠ¸ë¦¬êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì ¸ ìˆëŠ”ë°, í”íˆ ë³¼ ìˆ˜ ìˆëŠ” choiwheatley.github.ioë¥¼ ì˜ˆì‹œë¡œ ë“¤ë©´ ì˜¤ë¥¸ìª½ì—ì„œë¶€í„° `unnamed_root` > `io` > `github` > `choiwheatley` ìˆœìœ¼ë¡œ íŠ¸ë¦¬ê°€ ê¹Šì–´ì§„ë‹¤. ì²«ë²ˆì§¸ ë ˆë²¨ ë„ë©”ì¸ ì´ë¦„ì€ ICANNì—ì„œ ì •ì˜í•˜ê³  ë‘ë²ˆì§¸ ë„ë©”ì¸ ì´ë¦„ì€ ì„ ì°©ìˆœìœ¼ë¡œ(...)ì´ë¦„ì„ ì •ì˜í–ˆë‹¤ê³ . ì„¸ë²ˆì§¸ ë„ë©”ì¸ë¶€í„°ëŠ” ì„œë¸Œë„ë©”ì¸ìœ¼ë¡œ, ììœ ë¡­ê²Œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

## 11.4. The Sockets Interface

[[Socket Programming C API]]

**ì„œë²„ & í´ë¼ì´ì–¸íŠ¸ ê³µí†µ**

- `struct sockaddr_in`: IPì£¼ì†Œì™€ í¬íŠ¸ë²ˆí˜¸ê°€ ë¹… ì—”ë””ì–¸ìœ¼ë¡œ ë“¤ì–´ìˆëŠ” êµ¬ì¡°ì²´
- `struct sockaddr`: ì¼ë°˜í™”ëœ ì†Œì¼“ì£¼ì†Œ íƒ€ì…. `connect`, `bind`, `accept` í•  ë•Œ ìºìŠ¤íŒ… í•´ì•¼í•¨.
- `int socket(int domain, int type, int protocol)`: ì†Œì¼“ fdë¥¼ ë¦¬í„´í•œë‹¤.  [socket(2)](https://www.man7.org/linux/man-pages/man2/socket.2.html)
	- `domain`: `AF_INET` | `AF_INET6`
	- `type`: `SOCK_STREAM | SOCK_DGRAM`
	- `protocol`: 0

**í´ë¼ì´ì–¸íŠ¸**

- `int connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen)`: [connect(2)](https://man7.org/linux/man-pages/man2/connect.2.html)
	- ì†Œì¼“ ë””ìŠ¤í¬ë¦½í„°ë¡œ ì½ê¸° ì“°ê¸° ê°€ëŠ¥í•œ ìƒíƒœë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ì£¼ì†Œ ì •ë³´ë¥¼ ì¶”ê°€í•œë‹¤.

**ì„œë²„**

- `int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen)`:  [bind(2)](https://man7.org/linux/man-pages/man2/bind.2.html)
	- assign a name to a socket
	- use `getaddrinfo`to supply the arguments to `bind`
- `int listen(int sockfd, int backlog)`: [listen(2)](https://man7.org/linux/man-pages/man2/listen.2.html)
	- `sockfd`ë¥¼ ì•¡í‹°ë¸Œ ë””ìŠ¤í¬ë¦½í„°ì—ì„œ listening ë””ìŠ¤í¬ë¦½í„°ë¡œ ë°”ê¿” í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ìˆ˜ì‹ í•˜ëŠ” descriptorë¡œ ì‚¬ìš©ë˜ë„ë¡ ë§Œë“ ë‹¤.
	- `backlog`: íì˜ ìµœëŒ€ ê¸¸ì´ë¥¼ ì§€ì •.
	- `return`: í´ë¼ì´ì–¸íŠ¸ listening descriptorë¥¼ ë¦¬í„´í•œë‹¤.
- `int accept(int listenfd, struct sockaddr *addr, int *addrlen)`: 
	- client desciptorë¡œë¶€í„° ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ê¸°ê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.
	- `return`: connected deciptorë¥¼ ë¦¬í„´í•œë‹¤.
	- listening descriptorì™€ connected descriptor ì™€ì˜ ì°¨ì´
		- ì„œë²„ê°€ ì‚´ì•„ìˆëŠ” ë™ì•ˆ í•¨ê»˜ ì‚´ì•„ìˆëŠ” ë””ìŠ¤í¬ë¦½í„°ë¥¼ listening descriptorë¼ê³  ë¶€ë¥¸ë‹¤.
		- ì˜¤ì§ í•˜ë‚˜ì˜ ì»¤ë„¥ì…˜ì´ ì‚´ì•„ìˆëŠ” ë™ì•ˆì—ë§Œ ì¡´ì¬í•˜ëŠ” ë””ìŠ¤í¬ë¦½í„°ë¥¼ connected descriptorë¼ê³  ë¶€ë¥¸ë‹¤.

![[Pasted image 20230917194318.png|700]]

1. ì„œë²„ëŠ” `accept`ë¥¼ í˜¸ì¶œí•˜ì—¬ block ìƒíƒœê°€ ëœë‹¤.
2. í´ë¼ì´ì–¸íŠ¸ëŠ” `connect`ë¥¼ í˜¸ì¶œí•˜ë©° ì„œë²„ì—ê²Œ ì»¤ë„¥ì…˜ì„ ìš”ì²­í•œ ë’¤ block ìƒíƒœê°€ ëœë‹¤.
3. ì„œë²„ëŠ” block ìƒíƒœì—ì„œ ë²—ì–´ë‚˜ `accept`ë¥¼ í˜¸ì¶œí•˜ì—¬ connected descriptorë¥¼ íšë“í•œë‹¤. accept ì‘ë‹µì´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë‚ ì•„ê°€ í´ë¼ì´ì–¸íŠ¸ë¡œ block ìƒíƒœì—ì„œ ë²—ì–´ë‚˜ client desciptorë¥¼ íšë“í•œë‹¤. ì´ì œ ì„œë²„ëŠ” connected descriptorë¥¼ ì´ìš©í•˜ì—¬, í´ë¼ì´ì–¸íŠ¸ëŠ” client desciptorë¥¼ ì´ìš©í•˜ì—¬ ì†Œí†µí•  ìˆ˜ ìˆê²Œ ëœë‹¤.

### 11.4.7. Host and Service Conversion

**[[getaddrinfo]]**

**[[getnameinfo]]**

## 11.5. Web Servers

- *HTML*, Hyper Text Markup Language, ê·¸ë˜í”½ í™”ë©´ì— ë„ìš¸ ë‚´ìš©ì„ ì¸ê°„ë„, ì»´í“¨í„°ë„ ì½ì„ ìˆ˜ ìˆê²Œ ë§Œë“  ê·œê²©. íŠ¹ì§•ìœ¼ë¡œëŠ” í•˜ì´í¼ë§í¬ë¥¼ ê±¸ì–´ ë‹¤ë¥¸ ê³³ìœ¼ë¡œë„ ì´ë™í•  ìˆ˜ ìˆë‹¤.
- *MIME Type*, Multipurpose Internet Mail Extensionsë¡œ, ì—°ì†ëœ ë°”ì´íŠ¸ë¡œ ì „ì†¡ëœ ë¬¸ìì—´ì´ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ í•´ì„ë  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•œ ì¼ì¢…ì˜ í•´ë…ì§€ì´ë‹¤.
- *Static Content*: ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ë””ìŠ¤í¬ì— ì €ì¥ëœ íŒŒì¼ì„ ê°€ì ¸ì™€ ë³´ë‚´ì¤€ë‹¤. ì´ë•Œ ê·¸ íŒŒì¼ì„ ì •ì  ì»¨í…ì¸ ë¼ê³  ë³¼ ìˆ˜ ìˆìŒ.
- *Dynamic Content*: ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— **ì‹¤í–‰íŒŒì¼**ì„ ì‹¤í–‰í•œ ê²°ê³¼ë¥¼ ë³´ë‚´ì¤€ë‹¤. ì´ë•Œ ì‹¤í–‰ ê²°ê³¼ë¬¼ì„ ë™ì  ì»¨í…ì¸ ë¼ê³  ë³¼ ìˆ˜ ìˆìŒ.
- *URL*: Uniform Resource Locatorì˜ ì•½ìë¡œ, ì„œë²„ ì»¨í…ì¸ ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì‹ë³„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— *URI*(Uniform Resource Identifier)ë¼ê³ ë„ ë¶ˆë¦¬ìš´ë‹¤. `<í”„ë¡œí† ì½œ>://<í˜¸ìŠ¤íŠ¸>[:í¬íŠ¸][/][ë¦¬ì†ŒìŠ¤ íŒ¨ìŠ¤]`ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤.
	- ë™ì  ì»¨í…ì¸ ì˜ ê²½ìš°, í´ë¼ì´ì–¸íŠ¸ëŠ” URLì— ì‹¤í–‰íŒŒì¼ì˜ ì´ë¦„ê³¼ ê·¸ ì¸ìë¥¼ ë„£ì„ ìˆ˜ ìˆëŠ”ë°, íŒŒì¼ì´ë¦„ê³¼ ì¸ìë“¤ì„ êµ¬ë¶„í•˜ëŠ” `?` ì™€ ì¸ìë“¤ ì‚¬ì´ë¥¼ êµ¬ë¶„í•˜ëŠ” `&`ê°€ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´
	- `http://bluefish.ics.cs.cmu.edu:8000/cgi-bin/adder?16000&213`
	- ë‹¤ìŒ URLì€ `bluefish.ics.cs.cmu.edu` í˜¸ìŠ¤íŠ¸ì˜ 8000ë²ˆ í¬íŠ¸ì— ìƒì£¼í•˜ê³  ìˆëŠ” í”„ë¡œì„¸ìŠ¤ì—ê²Œ `adder`ë¼ëŠ” ì´ë¦„ì˜ ì‹¤í–‰íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¨ë‹¤. ì´ë•Œ ë‘ ì¸ì `16000`ê³¼ `213`ì„ ë„£ì—ˆë‹¤.
- HTTP Requests
	- request headers
		- `<method> <uri> <version>`
		- `<header-name>: <header-data>`
	- [?] Persistent connection?
	- [?] proxy cache?
- HTTP Responses
	- response headers
		- `<version> <status-code> <status-message>`
	- response body


**CGI (Common Gateway Interface)**

Dynamic Contentë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ì„œ í´ë¼ì´ì–¸íŠ¸ëŠ” URL ë¦¬ì†ŒìŠ¤ ë’¤ì— ì¸ìë¥¼ ì¶”ê°€í•œë‹¤ê³  í–ˆë‹¤. ê·¸ëŸ¬ë©´ ì„œë²„ê°€ ì´ë¥¼ ë¶„ë¦¬í•˜ê³  ë³„ë„ì˜ ë³€ìˆ˜(ë˜ëŠ” ë¦¬ìŠ¤íŠ¸)ì— ë‹´ì•˜ë‹¤ê³  ì¹˜ì. ì„œë²„ì—ì„œëŠ” ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚ ê¹Œ?

1. CGI í™˜ê²½ë³€ìˆ˜ ì¤‘ `QUERY_STRING`ì— ì¸ìëª©ë¡ì„ ê± ë„£ëŠ”ë‹¤.
2. ì‚¬ì „ì— ë“±ë¡ëœ CGI programì„ ì„œë²„ê°€ forkí•˜ê³  execveí•˜ì—¬ ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.
3. CGI í”„ë¡œì„¸ìŠ¤ëŠ” í•´ë‹¹ í™˜ê²½ë³€ìˆ˜ë¥¼ ì½ìŒìœ¼ë¡œì¨ ìì—°ìŠ¤ëŸ½ê²Œ ì¸ìë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤. íŒŒì‹±ê¹Œì§€ í•´ì£¼ë‚˜?
- [?] `dup2` fd ë¦¬ë””ë ‰ì…˜ ë•ë¶„ì— CGI í”„ë¡œì„¸ìŠ¤ëŠ” ë³„ ìƒê°ì—†ì´ stdoutìœ¼ë¡œ ë¦¬í„´í•˜ê¸°ë§Œ í•´ë„ ì•Œì•„ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì‘ë‹µì´ ê°„ë‹¤ê³ !

## Homework Problems

[[week06 {swjungle}{proxy-lab}]]ì—ì„œ ì œì•ˆí•œ ê³¼ì œë§Œ ì•„ë˜ì— ì ì–´ë‘ì—ˆë‹¤.

### 11.6c

> Inspect the output from `Tiny` to determine the version of HTTP your browser uses  
> `Tiny` ì¶œë ¥ê²°ê³¼ë¥¼ í†µí•´ ë‹¹ì‹ ì´ ì‚¬ìš©í•˜ëŠ” ë¸Œë¼ìš°ì € ë²„ì „ì„ ì•Œì•„ë³´ì„¸ìš”.

```
Accepted connection from (localhost, 54870)
Request headers:
GET / HTTP/1.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: ko-KR,ko;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate, br
DNT: 1
Connection: keep-alive
Cookie: csrftoken=y6OUxjxvrhDvbEQwpxvkkKlXpMGcZfh7
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
```

> `User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0`

### 11.7

> Extend `Tiny` so that it serves `MPG` video files. Check you work using a real browser  
> `Tiny`ê°€ `MPG` ì˜ìƒíŒŒì¼ì„ ì œê³µí•˜ë„ë¡ ê¸°ëŠ¥ì„ í™•ì¥í•´ ë³´ì„¸ìš”. ì‹¤ì œ ë¸Œë¼ìš°ì €ë¥¼ í™œìš©í•´ ì‹œë„í•´ ë³´ì„¸ìš”.

â—ï¸ `MPG` í¬ë§·ì´ ì•„ë‹Œ, `MP4` í¬ë§·ì„ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½.

![[ìŠ¤í¬ë¦°ìƒ· 2023-09-18 ì˜¤ì „ 11.12.07.png]]

### 11.9

> Modify `Tiny` so that when it serves static content, it copies the requested file to the connected descriptor using `malloc`, `rio_readn`, and `rio_writen`, instead of `mmap` and `rio_written`.  
> `Tiny`ë¥¼ ìˆ˜ì •í•´ì„œ ì •ì  ì»¨í…ì¸ ë¥¼ ì œê³µí•  ë•Œ `malloc`, `rio_readn`, `rio_writen`ì„ ì‚¬ìš©í•´ì„œ ë””ìŠ¤í¬ë¦½í„°ê°€ ì»¨í…ì¸ ë¥¼ ë³µì‚¬í•˜ë„ë¡ ë§Œë“¤ì–´ë³´ì„¸ìš”.

ì–´ë ¤ìš´ ìš©ì–´ë“¤ ë‚˜ì˜¨ë‹¤. descriptorëŠ” file desciptorë¥¼ ì˜ë¯¸í•˜ë‚˜? `rio` ì ‘ë‘ì–´ëŠ” ë¬´ì—‡ì„ í•˜ëŠ” ë…€ì„ì¼ê¹Œ?

â†’ [[10. System-Level IO {CSAPP}]]ì— ì œì•ˆëœ **R**obust **IO** íŒ¨í‚¤ì§€ì˜€ë‹¤...! 11ì¥ì˜ ë””íœë˜ì‹œê°€ 10ì¥ì— ìˆì—ˆë‹¤ë‹ˆ... ì´ë¶€ë¶„ë„ ì½ì–´ì•¼ í•˜ë‚˜?

**2023-09-18T11:12:45**

ì‰½ê²Œ ë§í•´ `mmap` ì“°ì§€ë§ê³  ë„ˆê°€ `malloc` ì¨ì„œ ì§ì ‘ ë©”ëª¨ë¦¬ë¥¼ ë§¤í•‘í•˜ë¼ ì´ ë§ì¸ë“¯.

**2023-09-18T14:26:55**

<iframe src="https://github.com/ChoiWheatley/swjungle-week06-proxy-lab/commit/c276f608a994f76b38cbaa32c9e5d50e5ed331c6#" allow="fullscreen" allowfullscreen="" style="height: 100%; width: 70%; aspect-ratio: 4 / 3;"></iframe>

### 11.10

> Write an HTML form for the CGI `adder` function in Figure 11.27. Your form should include two text boxes that users fill in with the two numbers to be added together. Your form should request content using `GET` method.  
> `adder` í•¨ìˆ˜ë¥¼ ìœ„í•œ í¼ HTMLì„ ì‘ì„±í•˜ì„¸ìš”. í¼ì€ ë‘ê°œì˜ í…ìŠ¤íŠ¸ ë°•ìŠ¤ë¡œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©° ìœ ì €ê°€ ê°ê°ì˜ ìˆ«ìë¥¼ ì±„ì›Œ ë„£ì–´ ë‘ ìˆ«ìë¥¼ ë”í•œ ê°’ì„ í™•ì¸í•˜ë„ë¡ í•´ë³´ì„¸ìš”. í¼ì€ `GET` ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ ìš”ì²­ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

â“ CGI? Computer Graphics Interface? ì•„ë‹ˆ, Common Gateway Interfaceì´ë‹¤

### 11.11

> Extend `Tiny` to support the HTTP `HEAD` method. Check your work using TELNET as a web client.  
> `Tiny`ê°€ `HEAD` ë©”ì„œë“œë¥¼ ì§€ì›í•˜ë„ë¡ í™•ì¥í•´ë³´ì„¸ìš”. í…”ë„·ì„ ì›¹ í´ë¼ì´ì–¸íŠ¸ë¡œ ê²°ê³¼ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”. 

ì•„ë‹ˆ ìš”ì¦˜ ëˆ„ê°€ í…”ë„·ì„ ì“°ëƒ? ë§›ì¢‹ì€ í¬ìŠ¤íŠ¸ë§¨ì´ ìˆëŠ”ë°!

ì¼ë‹¨ [request header](https://developer.mozilla.org/en-US/docs/Glossary/Request_header)ì˜ êµ¬ì„±ì„ ì¡°ì‚¬í•´ ë³¼ í•„ìš”ê°€ ìˆë‹¤.

> A request header is an HTTP header that can be used in an HTTP request to provide information about the request context, so that the server can tailor the response.

GET ë©”ì„œë“œì— ëŒ€í•œ request header ì˜ˆì‹œ. ì²« ì¤„ì—ëŠ” ë¬´ì¡°ê±´ ë©”ì„œë“œ, ì—”ë“œí¬ì¸íŠ¸, HTTP ë²„ì „ì´ ë“¤ì–´ê°€ëŠ”êµ¬ë‚˜.

```http
GET /home.html HTTP/1.1
Host: developer.mozilla.org
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:50.0) Gecko/20100101 Firefox/50.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: https://developer.mozilla.org/testpage.html
Connection: keep-alive
Upgrade-Insecure-Requests: 1
If-Modified-Since: Mon, 18 Jul 2016 02:36:04 GMT
If-None-Match: "c561c68d0ba92bbeb8b0fff2a9199f722e3a621a"
Cache-Control: max-age=0
```

ìƒê°í•´ ë³´ë‹ˆ `serve_static`ì—ì„œ bodyë¥¼ ì œì™¸í•œ ë¶€ë¶„ë§Œ ë³´ë‚´ë©´ ë˜ëŠ” ì•„ì£¼ ê°„ë‹¨í•œ ë¬¸ì œì˜€ë‹¤.

```c
/// @brief response header against HEAD request
void serve_static_head(int fd, char *filename, int filesize) {
  int srcfd;
  char *srcp, filetype[MAXLINE], buf[MAXBUF];

  // Send response headers to client
  get_filetype(filename, filetype);
  sprintf(buf, "HTTP/1.0 200 OK\r\n");
  sprintf(buf, "%sServer: Tiny Web Server\r\n", buf);
  sprintf(buf, "%sConnection: close\r\n", buf);
  sprintf(buf, "%sContent-Length: %d\r\n", buf, filesize);
  sprintf(buf, "%sContent-Type: %s\r\n\r\n", buf, filetype);

  // send to client response header
  Rio_writen(fd, buf, strlen(buf));

  // just for me
  printf("Response headers: \n");
  printf("%s", buf);

  // there are no body in this response! end function
}
```
